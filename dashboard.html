<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Clinic System | Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    :root{
      --bg: #f4f7fb;
      --card: #ffffff;
      --text: #0f172a;
      --muted: #64748b;
      --primary: #2563eb;
      --primary-2: #1e40af;
      --border: rgba(15, 23, 42, 0.08);
      --shadow: 0 10px 30px rgba(2, 6, 23, 0.08);
      --shadow2: 0 8px 20px rgba(2, 6, 23, 0.06);
      --radius: 16px;
    }

    body.dark{
      --bg: #0b1220;
      --card: #0f1b32;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --primary: #60a5fa;
      --primary-2: #3b82f6;
      --border: rgba(255,255,255,0.08);
      --shadow: 0 12px 36px rgba(0,0,0,0.35);
      --shadow2: 0 10px 24px rgba(0,0,0,0.28);
    }

    *{ box-sizing: border-box; }
    body{
      margin:0;
      font-family: "Segoe UI", Tahoma, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
    }
  </style>
</head>

<body>

<!-- ================= TOPBAR ================= -->
<div class="topbar">
  <div class="topbar-inner">
    <div class="brand">
      <div class="brand-badge">ğŸ¥</div>
      <div>
        <h1 id="uiTitle">Clinic System</h1>
        <p id="uiSub">Dashboard</p>
      </div>
    </div>

    <div class="actions">
      <div class="user-chip">
        <span class="chip-dot"></span>
        <span id="uiUser">Admin</span>
      </div>

      <button class="btn" id="btnLang">ğŸŒ <span id="uiLang">EN</span></button>
      <button class="btn" id="btnTheme">ğŸŒ“ <span id="uiTheme">Light</span></button>
      <button class="btn" id="btnLogout">ğŸšª Logout</button>
    </div>
  </div>
</div>

<!-- ================= DASHBOARD CONTENT (ÙƒÙ…Ø§ Ù‡Ùˆ) ================= -->
<div class="wrap">
  <div class="grid">

    <!-- LEFT -->
    <div class="card">
      <div class="card-head">
        <h3 class="card-title">ğŸ“Š Overview</h3>
        <span class="pill">JOD</span>
      </div>

      <div class="stats">
        <div class="stat">
          <div class="label">ğŸ‘¥ Patients</div>
          <div class="value">0</div>
          <div class="sub">Total registered</div>
        </div>

        <div class="stat">
          <div class="label">ğŸ“… Sessions</div>
          <div class="value">0</div>
          <div class="sub">All sessions</div>
        </div>

        <div class="stat">
          <div class="label">ğŸ’³ Payments</div>
          <div class="value">0</div>
          <div class="sub">Total collected</div>
        </div>
      </div>

      <div class="chart-wrap">
        <h3 class="card-title">ğŸ“ˆ Payments (Last 6 months)</h3>
        <canvas id="paymentsChart"></canvas>
      </div>
    </div>

    <!-- RIGHT -->
    <div class="side">
      <div class="card">
        <div class="card-head">
          <h3 class="card-title">âš¡ Quick Actions</h3>
          <span class="pill">Secure</span>
        </div>

        <div class="nav">
          <a href="patients.html">ğŸ‘¥ Patients</a>
          <a href="sessions.html">ğŸ“… Sessions</a>
          <a href="#" id="navPaymentsLink">ğŸ’³ Payments (PIN protected)</a>
          <a href="receive.html">ğŸ’° Receive</a>
          <a href="patient-report.html">ğŸ“„ Report</a>
          <a href="settings.html">âš™ï¸ Settings</a>
          <a href="users.html">ğŸ‘¤ Users</a>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- ================= ORIGINAL SCRIPTS ================= -->
<script src="assets/js/storage.js"></script>
<script src="assets/js/settings-system.js"></script>
<script type="module" src="assets/js/dashboard.module.js"></script>

<!-- ================= FUNCTIONALITY SCRIPT ================= -->
<script>
/* ===== THEME ===== */
const btnTheme = document.getElementById("btnTheme");
const uiTheme  = document.getElementById("uiTheme");

function applyTheme(theme){
  document.body.classList.toggle("dark", theme === "dark");
  uiTheme.textContent = theme === "dark" ? "Dark" : "Light";
  localStorage.setItem("theme", theme);
}
applyTheme(localStorage.getItem("theme") || "light");
btnTheme.onclick = () => {
  applyTheme(document.body.classList.contains("dark") ? "light" : "dark");
};

/* ===== LANGUAGE ===== */
const btnLang = document.getElementById("btnLang");
const uiLang  = document.getElementById("uiLang");

function applyLang(lang){
  uiLang.textContent = lang.toUpperCase();
  document.documentElement.dir = lang === "ar" ? "rtl" : "ltr";
  localStorage.setItem("lang", lang);
}
applyLang(localStorage.getItem("lang") || "en");
btnLang.onclick = () => {
  applyLang(localStorage.getItem("lang") === "en" ? "ar" : "en");
};

/* ===== LOGOUT ===== */
document.getElementById("btnLogout").onclick = () => {
  localStorage.removeItem("loggedIn");
  location.href = "index.html";
};

/* ===== PAYMENTS PIN ===== */
document.getElementById("navPaymentsLink").onclick = (e) => {
  e.preventDefault();
  const pin = localStorage.getItem("paymentPin");
  if(!pin){
    alert("Ù„Ù… ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† PIN Ø¨Ø¹Ø¯ Ù…Ù† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª");
    return;
  }
  const entered = prompt("Ø£Ø¯Ø®Ù„ PIN Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª");
  if(entered === pin){
    location.href = "payments.html";
  }else{
    alert("PIN ØºÙŠØ± ØµØ­ÙŠØ­");
  }
};
</script>

</body>
</html>
