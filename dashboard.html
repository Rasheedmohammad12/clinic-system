<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Clinic System | Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    :root{
      --bg: #f4f7fb;
      --card: #ffffff;
      --text: #0f172a;
      --muted: #64748b;
      --primary: #2563eb;
      --primary-2: #1e40af;
      --border: rgba(15, 23, 42, 0.08);
      --shadow: 0 10px 30px rgba(2, 6, 23, 0.08);
      --shadow2: 0 8px 20px rgba(2, 6, 23, 0.06);
      --radius: 16px;
    }

    body.dark{
      --bg: #0b1220;
      --card: #0f1b32;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --primary: #60a5fa;
      --primary-2: #3b82f6;
      --border: rgba(255,255,255,0.08);
      --shadow: 0 12px 36px rgba(0,0,0,0.35);
      --shadow2: 0 10px 24px rgba(0,0,0,0.28);
    }

    *{ box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin:0;
      font-family: "Segoe UI", Tahoma, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    .topbar{
      position: sticky;
      top: 0;
      z-index: 50;
      background: linear-gradient(135deg, var(--primary), var(--primary-2));
      color: #fff;
      padding: 14px 18px;
      box-shadow: var(--shadow2);
    }
    .topbar-inner{
      max-width: 1200px;
      margin: 0 auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
    }

    .brand{display:flex;gap:10px;align-items:center;}
    .brand-badge{
      width:40px;height:40px;border-radius:14px;
      background:rgba(255,255,255,.2);
      display:flex;align-items:center;justify-content:center;
    }

    .btn{
      border:none;border-radius:12px;
      padding:10px 12px;
      background:rgba(255,255,255,.18);
      color:#fff;cursor:pointer;
    }

    .wrap{max-width:1200px;margin:20px auto;padding:0 18px;}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:18px;}
    @media(max-width:900px){.grid{grid-template-columns:1fr;}}

    .card{
      background:var(--card);
      border-radius:16px;
      box-shadow:var(--shadow);
      padding:16px;
    }

    .nav{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:12px;
    }
    .nav a{
      text-decoration:none;
      color:var(--text);
      border:1px solid var(--border);
      border-radius:14px;
      padding:14px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
  </style>
</head>

<body>

<div class="topbar">
  <div class="topbar-inner">
    <div class="brand">
      <div class="brand-badge">ğŸ¥</div>
      <div>
        <b>Clinic System</b>
        <div style="font-size:12px">Dashboard</div>
      </div>
    </div>

    <div>
      <button class="btn" id="btnLang">ğŸŒ</button>
      <button class="btn" id="btnTheme">ğŸŒ“</button>
      <button class="btn" id="btnLogout">ğŸšª</button>
    </div>
  </div>
</div>

<div class="wrap">
  <div class="card">
    <h3>âš¡ Quick Actions</h3>

    <div class="nav">
      <a href="patients.html">ğŸ‘¥ Patients</a>
      <a href="#" id="navPaymentsLink">ğŸ’³ Payments</a>
      <a href="receive.html">ğŸ’° Receive</a>
      <a href="settings.html">âš™ï¸ Settings</a>
    </div>
  </div>
</div>

<!-- ===== SCRIPTS ===== -->

<script src="assets/js/storage.js"></script>

<!-- THEME -->
<script>
const btnTheme = document.getElementById("btnTheme");
function applyTheme(t){
  document.body.classList.toggle("dark", t==="dark");
  localStorage.setItem("theme",t);
}
applyTheme(localStorage.getItem("theme")||"light");
btnTheme.onclick=()=>applyTheme(
  document.body.classList.contains("dark")?"light":"dark"
);
</script>

<!-- LANGUAGE -->
<script>
const btnLang=document.getElementById("btnLang");
btnLang.onclick=()=>{
  const l=localStorage.getItem("lang")==="ar"?"en":"ar";
  localStorage.setItem("lang",l);
  document.documentElement.dir=l==="ar"?"rtl":"ltr";
};
</script>

<!-- LOGOUT -->
<script>
document.getElementById("btnLogout").onclick=()=>{
  localStorage.removeItem("loggedIn");
  location.href="index.html";
};
<script type="module">
import { verifyPaymentsPIN, t, getSettings } from "./assets/js/settings-system.js";
import { getCurrentUser } from "./assets/js/auth.js";

const user = getCurrentUser();
const paymentsLink = document.getElementById("navPaymentsLink");

paymentsLink.addEventListener("click", e => {
  e.preventDefault();

  if (!user) {
    alert("Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„");
    return;
  }

  // âœ… Ø¬Ù„Ø¨ Ø§Ù„Ù„ØºØ© Ø§Ù„ØµØ­ÙŠØ­Ø©
  const settings = getSettings(user.id);
  const lang = settings.lang;

  const pin = prompt(t(lang, "enterPin"));
  if (!pin) return;

  if (verifyPaymentsPIN(user.id, pin)) {
    window.location.href = "payments.html";
  } else {
    alert(t(lang, "wrongPin"));
  }
});
</script>


</body>
</html>
