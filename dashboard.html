<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Dashboard | Clinic System</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#f1f5f9;margin:0}
header{background:#2563eb;color:#fff;padding:20px}
.container{padding:25px}
.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px}
.card{background:#fff;padding:20px;border-radius:12px;box-shadow:0 6px 16px rgba(0,0,0,.08)}
.nav{margin-top:30px;display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:15px}
.nav a{background:#fff;padding:16px;border-radius:12px;text-decoration:none;color:#000;display:flex;align-items:center;gap:10px;box-shadow:0 6px 16px rgba(0,0,0,.06)}
.icon{background:#2563eb;color:#fff;width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center}
</style>
</head>

<body>

<header>
  <h2>ğŸ¥ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©</h2>
  <div id="userInfo"></div>
</header>

<div class="container">

<div class="stats">
  <div class="card">
    <h4>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø¶Ù‰</h4>
    <h1 id="patientsCount">0</h1>
  </div>
  <div class="card">
    <h4>Ø¹Ø¯Ø¯ Ø§Ù„Ø¬Ù„Ø³Ø§Øª</h4>
    <h1 id="sessionsCount">0</h1>
  </div>
  <div class="card">
    <h4>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª</h4>
    <h1 id="paymentsTotal">0 â‚ª</h1>
  </div>
</div>

<div class="nav">
  <a href="patients.html"><div class="icon">ğŸ‘¥</div>Ø§Ù„Ù…Ø±Ø¶Ù‰</a>
  <a href="sessions.html"><div class="icon">ğŸ“…</div>Ø§Ù„Ø¬Ù„Ø³Ø§Øª</a>

  <!-- Ø²Ø± Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª -->
  <a href="#" id="paymentsBtn">
    <div class="icon">ğŸ’³</div>Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª
  </a>

  <a href="patient-report.html"><div class="icon">ğŸ“„</div>ÙƒØ´Ù Ø­Ø³Ø§Ø¨</a>
  <a href="settings.html"><div class="icon">âš™ï¸</div>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</a>
  <a href="#" id="logoutLink"><div class="icon">ğŸšª</div>Ø®Ø±ÙˆØ¬</a>
</div>

</div>

<script src="assets/js/storage.js"></script>
<script src="assets/js/dashboard.js"></script>

<script type="module">
import { requireAuth, logout, getCurrentUser } from "./assets/js/auth.js";

requireAuth();

const user = getCurrentUser();
if(user){
  document.getElementById("userInfo").innerText =
    `Ù…Ø±Ø­Ø¨Ø§Ù‹ ${user.username} | ${user.role}`;
}

// Ø²Ø± Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª â†’ Ø·Ù„Ø¨ Ø§Ù„Ø±Ù…Ø²
document.getElementById("paymentsBtn").onclick = e => {
  e.preventDefault();

  const savedPin = localStorage.getItem("payments_pin");
  if(!savedPin){
    alert("âš ï¸ Ù„Ù… ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† Ø±Ù…Ø² Ø³Ø±ÙŠ Ù„Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª");
    window.location.href = "settings.html";
    return;
  }

  const entered = prompt("ğŸ” Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª:");
  if(entered === savedPin){
    sessionStorage.setItem("payments_access","true");
    window.location.href = "payments.html";
  }else{
    alert("âŒ Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­");
  }
};

// Ø®Ø±ÙˆØ¬
document.getElementById("logoutLink").onclick = e =>{
  e.preventDefault();
  sessionStorage.removeItem("payments_access");
  logout();
};
</script>

</body>
</html>
