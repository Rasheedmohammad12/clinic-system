<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Clinic System</title>
<style>
body{
    font-family:Arial,sans-serif;
    background:#f4f6f8;
    margin:0;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
}
.box{
    background:#fff;
    padding:25px;
    border-radius:10px;
    width:480px;
    box-shadow:0 4px 15px rgba(0,0,0,.1);
    text-align:center;
    position:relative;
}
input,button{
    width:100%;
    padding:10px;
    margin-top:8px;
}
button{
    background:#007bff;
    color:#fff;
    border:none;
    border-radius:5px;
    cursor:pointer;
}
.logout{background:#dc3545}
.back{background:#6c757d}
.delete{background:#dc3545;font-size:12px;padding:6px 10px;width:auto;margin-top:0}
.hidden{display:none}
.menu button{margin-top:8px}
ul{list-style:none;padding:0;margin-top:15px;text-align:left}
li{
    background:#f1f3f5;
    padding:8px;
    border-radius:5px;
    margin-bottom:6px;
    font-size:14px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
}
.total{
    margin-top:10px;
    font-weight:bold;
}
.langBtn{
    position:absolute;
    top:12px;
    right:12px;
    width:auto;
    padding:6px 10px;
    background:#111827;
    font-size:12px;
}
.rtl{
    direction:rtl;
    text-align:right;
}
.rtl ul{ text-align:right; }
.rtl li{ flex-direction:row-reverse; }
.smallNote{
    font-size:12px;
    color:#6b7280;
    margin-top:8px;
}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginBox" class="box">
    <button class="langBtn" onclick="toggleLang()" id="langBtnLogin">AR</button>
    <h2 id="loginTitle">Clinic Login</h2>
    <input type="password" id="password" placeholder="Password">
    <button onclick="login()" id="loginBtn">Login</button>
    <p id="error" style="color:red"></p>
    <div class="smallNote" id="loginHint">Password: clinic123</div>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="box hidden">
    <button class="langBtn" onclick="toggleLang()" id="langBtnDash">AR</button>
    <h2 id="dashTitle">Dashboard</h2>
    <div class="menu">
        <button onclick="openPatients()" id="patientsNav">Patients</button>
        <button onclick="openAppointments()" id="appointmentsNav">Appointments</button>
        <button onclick="openRevenues()" id="revenuesNav">Revenues</button>
        <button class="logout" onclick="logout()" id="logoutBtn">Logout</button>
    </div>
</div>

<!-- PATIENTS -->
<div id="patientsPage" class="box hidden">
    <button class="langBtn" onclick="toggleLang()" id="langBtnPatients">AR</button>
    <h2 id="patientsTitle">Patients</h2>
    <input id="patientName" placeholder="Patient name">
    <button onclick="addPatient()" id="addPatientBtn">Add</button>
    <ul id="patientsList"></ul>
    <button class="back" onclick="showDashboard()" id="backPatients">Back</button>
</div>

<!-- APPOINTMENTS -->
<div id="appointmentsPage" class="box hidden">
    <button class="langBtn" onclick="toggleLang()" id="langBtnApps">AR</button>
    <h2 id="appointmentsTitle">Appointments</h2>
    <input id="appPatient" placeholder="Patient name">
    <input type="date" id="appDate">
    <button onclick="addAppointment()" id="addAppointmentBtn">Add</button>
    <ul id="appointmentsList"></ul>
    <button class="back" onclick="showDashboard()" id="backAppointments">Back</button>
</div>

<!-- REVENUES -->
<div id="revenuesPage" class="box hidden">
    <button class="langBtn" onclick="toggleLang()" id="langBtnRev">AR</button>
    <h2 id="revenuesTitle">Revenues</h2>
    <input id="revReason" placeholder="Reason">
    <input type="number" id="revAmount" placeholder="Amount">
    <button onclick="addRevenue()" id="addRevenueBtn">Add</button>
    <ul id="revenuesList"></ul>
    <div class="total" id="totalWrap">Total: $<span id="totalRevenue">0</span></div>
    <button class="back" onclick="showDashboard()" id="backRevenues">Back</button>
</div>

<script>
// ===== I18N =====
const dict = {
  en: {
    loginTitle:"Clinic Login",
    passwordPh:"Password",
    loginBtn:"Login",
    loginHint:"Password: clinic123",
    dashTitle:"Dashboard",
    patientsNav:"Patients",
    appointmentsNav:"Appointments",
    revenuesNav:"Revenues",
    logoutBtn:"Logout",
    patientsTitle:"Patients",
    patientNamePh:"Patient name",
    add:"Add",
    back:"Back",
    appointmentsTitle:"Appointments",
    revenuesTitle:"Revenues",
    reasonPh:"Reason",
    amountPh:"Amount",
    total:"Total",
    wrongPass:"Wrong password",
    del:"X"
  },
  ar: {
    loginTitle:"تسجيل دخول العيادة",
    passwordPh:"كلمة المرور",
    loginBtn:"دخول",
    loginHint:"كلمة المرور: clinic123",
    dashTitle:"لوحة التحكم",
    patientsNav:"المرضى",
    appointmentsNav:"المواعيد",
    revenuesNav:"الإيرادات",
    logoutBtn:"تسجيل خروج",
    patientsTitle:"المرضى",
    patientNamePh:"اسم المريض",
    add:"إضافة",
    back:"رجوع",
    appointmentsTitle:"المواعيد",
    revenuesTitle:"الإيرادات",
    reasonPh:"السبب",
    amountPh:"المبلغ",
    total:"المجموع",
    wrongPass:"كلمة المرور غير صحيحة",
    del:"حذف"
  }
};

let lang = localStorage.getItem("lang") || "en";

function applyLang(){
  const t = dict[lang];

  // direction
  document.documentElement.lang = lang;
  const pages = [loginBox, dashboard, patientsPage, appointmentsPage, revenuesPage];
  pages.forEach(p => p.classList.toggle("rtl", lang === "ar"));

  // button labels for lang toggle
  const toggleLabel = (lang === "en") ? "AR" : "EN";
  ["langBtnLogin","langBtnDash","langBtnPatients","langBtnApps","langBtnRev"].forEach(id=>{
    const el = document.getElementById(id);
    if(el) el.innerText = toggleLabel;
  });

  // login
  loginTitle.innerText = t.loginTitle;
  password.placeholder = t.passwordPh;
  loginBtn.innerText = t.loginBtn;
  loginHint.innerText = t.loginHint;

  // dashboard
  dashTitle.innerText = t.dashTitle;
  patientsNav.innerText = t.patientsNav;
  appointmentsNav.innerText = t.appointmentsNav;
  revenuesNav.innerText = t.revenuesNav;
  logoutBtn.innerText = t.logoutBtn;

  // patients
  patientsTitle.innerText = t.patientsTitle;
  patientName.placeholder = t.patientNamePh;
  addPatientBtn.innerText = t.add;
  backPatients.innerText = t.back;

  // appointments
  appointmentsTitle.innerText = t.appointmentsTitle;
  appPatient.placeholder = t.patientNamePh;
  addAppointmentBtn.innerText = t.add;
  backAppointments.innerText = t.back;

  // revenues
  revenuesTitle.innerText = t.revenuesTitle;
  revReason.placeholder = t.reasonPh;
  revAmount.placeholder = t.amountPh;
  addRevenueBtn.innerText = t.add;
  backRevenues.innerText = t.back;
  totalWrap.firstChild.textContent = t.total + ": $";

  // re-render lists to update delete label
  renderPatients();
  renderAppointments();
  renderRevenues();
}

function toggleLang(){
  lang = (lang === "en") ? "ar" : "en";
  localStorage.setItem("lang", lang);
  applyLang();
}

// ===== AUTH =====
if(localStorage.getItem("loggedIn")==="true") showDashboard();

// ===== DATA =====
let patients = JSON.parse(localStorage.getItem("patients")) || [];
let appointments = JSON.parse(localStorage.getItem("appointments")) || [];
let revenues = JSON.parse(localStorage.getItem("revenues")) || [];

// ===== NAV =====
function hideAll(){
  loginBox.classList.add("hidden");
  dashboard.classList.add("hidden");
  patientsPage.classList.add("hidden");
  appointmentsPage.classList.add("hidden");
  revenuesPage.classList.add("hidden");
}
function showDashboard(){ hideAll(); dashboard.classList.remove("hidden"); }
function openPatients(){ hideAll(); patientsPage.classList.remove("hidden"); renderPatients(); }
function openAppointments(){ hideAll(); appointmentsPage.classList.remove("hidden"); renderAppointments(); }
function openRevenues(){ hideAll(); revenuesPage.classList.remove("hidden"); renderRevenues(); }

// ===== LOGIN / LOGOUT =====
function login(){
  if(password.value === "clinic123"){
    localStorage.setItem("loggedIn","true");
    error.innerText = "";
    showDashboard();
  } else {
    error.innerText = dict[lang].wrongPass;
  }
}
function logout(){
  localStorage.removeItem("loggedIn");
  location.reload();
}

// ===== PATIENTS =====
function addPatient(){
  const name = patientName.value.trim();
  if(!name) return;
  patients.push(name);
  localStorage.setItem("patients", JSON.stringify(patients));
  patientName.value = "";
  renderPatients();
}
function deletePatient(i){
  patients.splice(i,1);
  localStorage.setItem("patients", JSON.stringify(patients));
  renderPatients();
}
function renderPatients(){
  if(!patientsList) return;
  patientsList.innerHTML = "";
  const delLabel = dict[lang].del;
  patients.forEach((p,i)=>{
    patientsList.innerHTML += `<li><span>${escapeHtml(p)}</span><button class="delete" onclick="deletePatient(${i})">${delLabel}</button></li>`;
  });
}

// ===== APPOINTMENTS =====
function addAppointment(){
  const name = appPatient.value.trim();
  const date = appDate.value;
  if(!name || !date) return;
  appointments.push({n:name, d:date});
  localStorage.setItem("appointments", JSON.stringify(appointments));
  appPatient.value = "";
  appDate.value = "";
  renderAppointments();
}
function deleteAppointment(i){
  appointments.splice(i,1);
  localStorage.setItem("appointments", JSON.stringify(appointments));
  renderAppointments();
}
function renderAppointments(){
  if(!appointmentsList) return;
  appointmentsList.innerHTML = "";
  const delLabel = dict[lang].del;
  appointments.forEach((a,i)=>{
    appointmentsList.innerHTML += `<li><span>${escapeHtml(a.n)} - ${escapeHtml(a.d)}</span><button class="delete" onclick="deleteAppointment(${i})">${delLabel}</button></li>`;
  });
}

// ===== REVENUES =====
function addRevenue(){
  const reason = revReason.value.trim();
  const amount = Number(revAmount.value);
  if(!reason || !revAmount.value) return;
  revenues.push({r:reason, a:amount});
  localStorage.setItem("revenues", JSON.stringify(revenues));
  revReason.value = "";
  revAmount.value = "";
  renderRevenues();
}
function deleteRevenue(i){
  revenues.splice(i,1);
  localStorage.setItem("revenues", JSON.stringify(revenues));
  renderRevenues();
}
function renderRevenues(){
  if(!revenuesList) return;
  revenuesList.innerHTML = "";
  const delLabel = dict[lang].del;
  let total = 0;
  revenues.forEach((x,i)=>{
    total += Number(x.a || 0);
    revenuesList.innerHTML += `<li><span>${escapeHtml(x.r)} - $${escapeHtml(String(x.a))}</span><button class="delete" onclick="deleteRevenue(${i})">${delLabel}</button></li>`;
  });
  totalRevenue.innerText = total;
}

// ===== HELPERS =====
function escapeHtml(str){
  return String(str)
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

// init language
applyLang();
</script>

</body>
</html>
